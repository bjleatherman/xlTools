Sub GetImportFeaturesCsv()
    CopySheetAndSave "JobNum Import Features", "Import Features"
End Sub

Sub GetImportJointNoCsv()
    CopySheetAndSave "JobNum Import Joint No", "Import Joint No"
End Sub

Sub GetImportWeldsCsv()
    CopySheetAndSave "JobNum Import Welds", "Import Welds"
End Sub

Sub GetImportGpsCsv()
    CopySheetAndSave "JobNum GPS Interp", "GPS Interp"
End Sub

Sub CopySheetAndSave(sheetName, defaultName)
    
    Dim sourceWorkbook As Workbook
    Dim newWorkbook As Workbook
    Dim sourceSheet As Worksheet
    Dim savePath As Variant

    ' Open PERSONAL.XLSB
    On Error Resume Next
    Set sourceWorkbook = Workbooks("PERSONAL.XLSB")
    If sourceWorkbook Is Nothing Then
        Set sourceWorkbook = Workbooks.Open(Environ("APPDATA") & "\Microsoft\Excel\XLSTART\PERSONAL.XLSB")
    End If
    On Error GoTo 0

    ' Specify the sheet name you want to copy
    Set sourceSheet = sourceWorkbook.Sheets(sheetName)

    ' Create a new workbook
    Set newWorkbook = Workbooks.Add

    ' Copy the sheet to the new workbook
    sourceSheet.Copy Before:=newWorkbook.Sheets(1)
    
    ' Delete the empty, default sheet
    Application.DisplayAlerts = False
    newWorkbook.Sheets("Sheet1").Delete
    Application.DisplayAlerts = True

    ' Ask user to specify the filename and path to save the workbook
    savePath = Application.GetSaveAsFilename( _
        InitialFileName:=defaultName & ".csv", _
        FileFilter:="Csv (*.csv), *.csv", _
        Title:="Save As")

    ' Check if the user has cancelled the dialog
    If savePath <> False Then
        newWorkbook.SaveAs Filename:=savePath, FileFormat:=xlOpenXMLWorkbook
    End If

    ' Keep the new workbook open and show it
    newWorkbook.Activate
End Sub


